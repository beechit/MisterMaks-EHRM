<f:layout name="Ajax"/>{namespace ehrm=Beech\Ehrm\ViewHelpers}

<f:section name="Body">

	<h1>Person information</h1>

	<div id="c261" class="csc-default">
		<ul id="personTabs" class="nav nav-tabs">
			<li class="active">
				<a data-toggle="tab" href="#personal">General</a>
			</li>
			<li>
				<a data-toggle="tab" href="#education">Education</a>
			</li>
			<li>
				<a data-toggle="tab" href="#contract">Contract</a>
			</li>
			<li>
				<a data-toggle="tab" href="#documents">Documents</a>
			</li>
		</ul>
		<div id="personTabsContent" class="tab-content">
			<div id="personal" class="tab-pane fade active in">
				<f:render partial="Views/Show/Person" arguments="{_all}"/>
				<table id="addresses-{person.id}" class="table table-striped table-bordered">
					<tbody>
					<tr>
						<td class="span6">
							<f:render partial="Views/Show/Address" arguments="{address: person.address_home}"/>
							<a href="{f:uri.action(package:'Beech.Party', subpackage:'Administration', controller:'Address', action:'list', arguments: {party: person})}"
							   data-toggle="modal-ajax" data-target="#modal" modal-size="large"
							   data-reload="{f:uri.action(package:'Beech.Party', controller:'Person', action:'show', arguments: {person: person})}">
								<i class="icon-pencil icon-white"></i>
								<f:translate id="action.edit">Edit</f:translate>
							</a>
						</td>
						<td class="span6">
							<f:render partial="Views/Show/Address" arguments="{address: person.address_work}"/>
							<a href="{f:uri.action(package:'Beech.Party', subpackage:'Administration', controller:'Address', action:'list', arguments: {party: person})}"
							   data-toggle="modal-ajax" data-target="#modal" modal-size="large"
							   data-reload="{f:uri.action(package:'Beech.Party', controller:'Person', action:'show', arguments: {person: person})}">
								<i class="icon-pencil icon-white"></i>
								<f:translate id="action.edit">Edit</f:translate>
							</a>
						</td>
					</tr>
					</tbody>
				</table>
			</div>
			<div id="education" class="tab-pane fade">
				<f:for each="{educations}" as="education">
					<div id="education-{education.id}">
						<f:render partial="Views/Show/Education" arguments="{education: education}"/>
					</div>
				</f:for>
				<a href="{f:uri.action(package:'Beech.Party', subpackage:'Administration', controller:'Education', action:'list', arguments: {party: person})}"
				   data-toggle="modal-ajax" data-target="#modal" modal-size="large"
				   data-reload="{f:uri.action(package:'Beech.Party', controller:'Person', action:'show', arguments: {person: person})}">
					<i class="icon-pencil icon-white"></i>
					<f:translate id="action.edit">Edit</f:translate>
				</a>
			</div>
			<div id="contract" class="tab-pane fade">
				contract...<br/>
			</div>
			<div id="documents" class="tab-pane fade">
				<div style="position: absolute; height: 100%">
					Filter: <ehrm:form.select name="documentType" class="documentType" options="{documentCategories}" optionLabelField="typeName"/>

					<style>.chzn-container {width: 200px!important;}</style>
				</div>

				<table class="table" id="personDocuments">
					<thead>
					<tr>
						<th><f:translate id="name">Name</f:translate></th>
						<th><f:translate id="documentType">Category</f:translate></th>
						<th>&nbsp;</th>
					</tr>
					</thead>
					<f:for each="{documents}" as="document" iteration="documentIterator">
						<tr>
							<td><a href="#/document/show/{document.id}">{document.name}</a></td>
							<td>{document.documentType.categoryName} / {document.documentType.typeName}<br/>
								<f:for each="{document.resources}" as="resource">
									<i>{resource.contentType}</i>
								</f:for>
							</td>
							<td>
								<div class="btn-group">
									<button class="btn btn-small">Acties</button>
									<button class="btn btn-small dropdown-toggle" data-toggle="dropdown">
										<span class="caret"></span>
									</button>
									<ul class="dropdown-menu">
										<li><a href="/download/{document.id}"><i class="icon-download-alt"></i>Download </a></li>
										<li><a href="#/document/delete/{document.id}"><i class="icon-trash"></i>Verwijderen</a></li>
									</ul>
								</div>
							</td>
						</tr>
					</f:for>
				</table>
				<div style="text-align: right;">
					<a id="addDocument" class="btn btn-primary" href="{f:uri.action(package:'Beech.Document', controller:'Document', action:'new', arguments: {party: person})}"
															data-toggle="modal-ajax" data-target="#modal" modal-size="large"
															data-reload="{f:uri.action(package:'Beech.Party', controller:'Person', action:'show', arguments: {person: person})}">
					<i class="icon-plus icon-white"></i>
					<f:translate id="action.add">Add</f:translate>
				</a><div>

			</div>
		</div>
		</div>
	</div>
	<script type="text/javascript">
		var oPersonDocumentsTable = $('#personDocuments')
				.dataTable({
					"sDom": 'f'
				})
		$('select.documentType').change( function() { oPersonDocumentsTable.fnFilter( $(this).find('option:selected').text() ); } );
		$('#addDocument').on('click', function() {
			$(this).attr('href', $(this).attr('href').replace('person', 'trrr'))
		})
	</script>
</f:section>